{{- define "main" -}}
<section class="container my-5">
  <header class="mb-5">
    <h1>{{ .Title }}</h1>
    {{- with .Content -}}
      <div class="text-muted">
        {{ . }}
      </div>
    {{- end -}}
  </header>

  {{- $quotes := .Site.Data.socialproof.quotes -}}
  {{- $category := .Params.category -}}
  {{- if $category -}}
    {{- $quotes = where $quotes "category" $category -}}
  {{- end -}}
  {{- $sortedQuotes := sort $quotes "date" "desc" -}}

  <nav class="d-flex justify-content-start gap-2 mb-4 flex-wrap">
    <a href="/social-proof/" class="btn btn-sm {{ if not $category }}btn-primary{{ else }}btn-outline-primary{{ end }}">All ({{ len .Site.Data.socialproof.quotes }})</a>
    <a href="/social-proof/consulting/" class="btn btn-sm {{ if eq $category "consulting" }}btn-primary{{ else }}btn-outline-primary{{ end }}">Consulting ({{ len (where .Site.Data.socialproof.quotes "category" "consulting") }})</a>
    <a href="/social-proof/training/" class="btn btn-sm {{ if eq $category "training" }}btn-primary{{ else }}btn-outline-primary{{ end }}">Training ({{ len (where .Site.Data.socialproof.quotes "category" "training") }})</a>
  </nav>

  <div class="text-muted mb-4" style="font-size: 0.9rem;">
    <p>Showing {{ len $sortedQuotes }} testimonials</p>
  </div>

  <div>
    {{- range $sortedQuotes -}}
      <div class="mb-4 pb-4 border-bottom">
        <blockquote class="mb-3">
          <p>{{ .text }}</p>
        </blockquote>
        <footer>
          <cite class="text-body not-italic">
            <strong>{{ .name }}</strong>
            {{- with .title }}{{ if ne . "" }}<br><span class="text-muted" style="font-size: 0.9rem;">{{ . }}</span>{{ end }}{{ end -}}
          </cite>
          <div class="d-flex flex-wrap gap-2 align-items-center mt-2" style="font-size: 0.9rem;">
            {{- with .relationship }}<span class="badge bg-primary-subtle text-primary">{{ . }}</span>{{ end -}}
            {{- with .class }}<span class="badge bg-warning-subtle text-warning">{{ . | upper }}</span>{{ end -}}
            {{- with .stars }}<span class="text-warning">{{ range seq . }}‚≠ê{{ end }}</span>{{ end -}}
            {{- with .date }}<time datetime="{{ . }}" class="text-muted">{{ dateFormat "2 Jan 2006" . }}</time>{{ end -}}
          </div>
        </footer>
      </div>
    {{- end -}}
  </div>
</section>

{{- end -}}
