
{{- define "headline" }}
  <section class="container my-5">
    {{ .Content }}
  </section>
{{- end }}

{{- define "main" }}
  {{- /* Problems I Solve - 3 items */ -}}
  {{ $problemsSection := .Site.GetPage "section" "problems" }}
  <section class="container my-5">
    <h2>{{ $problemsSection.Title }}</h2>
    {{ $problemsSection.Content }}
    <div class="row g-4">
      {{ $problems := where .Site.RegularPages "Section" "problems" }}
      {{ range first 3 $problems }}
        {{ partial "components/promo-card.html" . }}
      {{ end }}
    </div>
  </section>

  {{- /* Outcomes I Deliver - 2 items */ -}}
  {{ $outcomesSection := .Site.GetPage "section" "outcomes" }}
  <section class="container my-5">
    <h2>{{ $outcomesSection.Title }}</h2>
    {{ $outcomesSection.Content }}
    <div class="row g-4">
      {{ $outcomes := where .Site.RegularPages "Section" "outcomes" }}
      {{ range first 3 $outcomes }}
        {{ partial "components/promo-card.html" . }}
      {{ end }}
    </div>
  </section>

  {{- /* Social Proof - Top 3 by weight */ -}}
  {{ $socialProofSection := .Site.GetPage "section" "social-proof" }}
  <section class="container my-5">
    <h2>What Clients Say</h2>
    {{ $socialProofPages := $socialProofSection.Pages.ByWeight }}
    {{ partial "components/social-proof-list.html" (dict "pages" $socialProofPages "limit" 3 "truncate" 30 "layout" "grid") }}
    <div class="text-center mt-5">
      <a href="{{ $socialProofSection.Permalink }}" class="btn btn-primary">View All Social Proof</a>
    </div>
  </section>

  <script>
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.quote-toggle').forEach(function(btn) {
      let expanded = false;
      const fullText = btn.getAttribute('data-full-text');
      const shortText = btn.getAttribute('data-short-text');
      const textSpan = btn.previousElementSibling;
      
      btn.addEventListener('click', function() {
        expanded = !expanded;
        if (expanded) {
          textSpan.textContent = fullText;
          btn.textContent = 'less';
        } else {
          textSpan.textContent = shortText + '...';
          btn.textContent = 'more...';
        }
      });
    });
  });
  </script>

  {{- /* Clients - 8 logos */ -}}
  <section class="container my-5">
    <h2>Trusted By</h2>
    <p class="text-muted mb-4">Organisations I've worked with to improve delivery outcomes and engineering excellence</p>
    {{ $clientsData := .Site.Data.clients }}
    {{ partial "components/client-logos.html" (dict "clients" $clientsData "limit" 8) }}
  </section>

  {{- /* Case Studies - 3 items */ -}}
  <section class="container my-5">
      {{ $caseStudiesSection := .Site.GetPage "section" "case-studies" }}
    <h2>{{ $caseStudiesSection.Title }}</h2>
    {{ $caseStudiesSection.Content }}
    <div class="row g-4">
      {{ $caseStudies := where .Site.RegularPages "Section" "case-studies" }}
      {{ range first 3 $caseStudies }}
        {{ partial "components/promo-card.html" . }}
      {{ end }}
    </div>
    <div class="text-center mt-4">
      <a href="{{ $caseStudiesSection.Permalink }}" class="btn btn-primary">View All Case Studies</a>
    </div>
  </section>

  {{- /* Recent Insights - 3 items */ -}}
  <section class="container my-5">
    {{ $insightsSection := .Site.GetPage "section" "insights" }}
    <h2>{{ $insightsSection.Title }}</h2>
    {{ $insightsSection.Content }}
    <div class="row g-4">
      {{ $insights := where .Site.RegularPages "Section" "insights" }}
       <div class="row g-4">
      {{ range first 9 $insights }}
        {{ partial "components/promo-card.html" . }}
      {{ end }}
      </div>
    </div>
    <div class="text-center mt-4">
      <a href="{{ $insightsSection.Permalink }}" class="btn btn-primary">View All Insights</a>
    </div>
  </section>

{{- end }}
