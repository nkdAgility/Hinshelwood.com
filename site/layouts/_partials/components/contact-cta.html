{{- $variant := .variant | default "default" -}}
{{- $heading := .heading | default "Ready to Address Your Delivery Constraints?" -}}
{{- $text := .text | default "If delivery predictability, flow, or engineering confidence are limiting your organisation's performance, the next step is a short conversation to determine whether there is a meaningful constraint worth addressing." -}}
{{- $showLocation := .showLocation | default false -}}
{{- $directBooking := .directBooking | default false -}}
{{- $buttonText := .buttonText | default "" -}}

{{- $calendarUrl := "https://outlook.office.com/bookwithme/user/ee9f3ad4c36a4455bd6925cd99e2192c@nkdagility.com/meetingtype/yAUp9As3uE-ocExerASCFA2?anonymous&ismsaljsauthenabled&ep=mlink" -}}


<div class="contact-cta card border-primary {{ if eq $variant "compact" }}p-3 bg-light{{ else }}p-4 bg-light{{ end }} my-4">
  <div class="card-body p-0">
    {{- if ne $variant "minimal" }}
      <h3 class="{{ if eq $variant "compact" }}h5{{ else }}h4{{ end }} mb-3">{{ $heading }}</h3>
    {{- end }}


    <p class="{{ if eq $variant "compact" }}mb-3 small{{ else }}mb-3{{ end }}">{{ $text }}</p>

    <p class="mb-3"><strong>No sales theatre. No obligation.</strong></p>

    {{- if $directBooking }}
      {{/* Direct booking variant: Main button goes to calendar, email option */}}
      <div class="d-flex flex-column flex-md-row gap-3 align-items-md-center mb-3">
        <a href="{{ $calendarUrl }}" target="_blank" rel="noopener" class="btn btn-primary {{ if eq $variant "compact" }}btn-sm{{ else }}btn-lg{{ end }}"> {{- if ne $buttonText "" }}{{ $buttonText }}{{- else }}ðŸ“… Book Diagnostic Conversation{{- end }} </a>
        <span class="text-muted {{ if eq $variant "compact" }}small{{ end }}">or email <a href="mailto:martin@nkdagility.com?subject=Diagnostic Conversation on Delivery Constraints" class="text-decoration-none">martin@nkdagility.com</a></span>
      </div>
    {{- else }}
      {{/* Default variant: Main button to assessment page, smaller book now and email options */}}
      <div class="d-flex flex-column flex-md-row gap-3 align-items-md-center mb-3">
        <a href="/diagnostic-assessment/" class="btn btn-primary {{ if eq $variant "compact" }}btn-sm{{ else }}btn-lg{{ end }}"> {{- if ne $buttonText "" }}{{ $buttonText }}{{- else }}Understand Diagnostic Assessment{{- end }} </a>
        <div class="d-flex flex-column flex-md-row gap-2 align-items-md-center small text-muted">
          <span>or <a href="{{ $calendarUrl }}" target="_blank" rel="noopener" class="text-decoration-none">book now</a></span>
          <span class="d-none d-md-inline">â€¢</span>
          <span><a href="mailto:martin@nkdagility.com?subject=Diagnostic Conversation on Delivery Constraints" class="text-decoration-none">email</a></span>
        </div>
      </div>
    {{- end }}

    {{- if $showLocation }}
      <p class="text-muted small mb-0"><strong>Location:</strong> Mexico / UK</p>
    {{- end }}
  </div>
</div>
